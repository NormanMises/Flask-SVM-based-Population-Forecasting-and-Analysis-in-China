{% extends 'base.html' %}

{% block head %}
    <title>
        中国人口分析与预测 - 人口分析
    </title>
{% endblock %}

{% block body %}
    <aside
            class="sidenav navbar navbar-vertical navbar-expand-xs border-0 bg-slate-900 fixed-start "
            id="sidenav-main">
        <div class="sidenav-header">
            <i
                    class="fas fa-times p-3 cursor-pointer text-secondary opacity-5 position-absolute end-0 top-0 d-none d-xl-none"
                    aria-hidden="true" id="iconSidenav"></i>
            <a class="navbar-brand d-flex align-items-center m-0"
               href="/"
               target="_blank">
                <span class="font-weight-bold text-lg">中国人口分析与预测</span>
            </a>
        </div>

        <div class="collapse navbar-collapse px-4  w-auto "
             id="sidenav-collapse-main">
            <ul class="navbar-nav">

                <li class="nav-item">
                    <a class="nav-link" href="/">
                        <div
                                class="icon icon-shape icon-sm px-0 text-center d-flex align-items-center justify-content-center">
                            <svg width="30px" height="30px" viewBox="0 0 48 48"
                                 version="1.1"
                                 xmlns="http://www.w3.org/2000/svg">
                                <title>小组构成</title>
                                <g id="dashboard" stroke="none" stroke-width="1"
                                   fill="none"
                                   fill-rule="evenodd">
                                    <g id="template"
                                       transform="translate(12.000000, 12.000000)"
                                       fill="#FFFFFF" fill-rule="nonzero">
                                        <path class="color-foreground"
                                              d="M0,1.71428571 C0,0.76752 0.76752,0 1.71428571,0 L22.2857143,0 C23.2325143,0 24,0.76752 24,1.71428571 L24,5.14285714 C24,6.08962286 23.2325143,6.85714286 22.2857143,6.85714286 L1.71428571,6.85714286 C0.76752,6.85714286 0,6.08962286 0,5.14285714 L0,1.71428571 Z"
                                              id="Path"></path>
                                        <path class="color-background"
                                              d="M0,12 C0,11.0532171 0.76752,10.2857143 1.71428571,10.2857143 L12,10.2857143 C12.9468,10.2857143 13.7142857,11.0532171 13.7142857,12 L13.7142857,22.2857143 C13.7142857,23.2325143 12.9468,24 12,24 L1.71428571,24 C0.76752,24 0,23.2325143 0,22.2857143 L0,12 Z"
                                              id="Path"></path>
                                        <path class="color-background"
                                              d="M18.8571429,10.2857143 C17.9103429,10.2857143 17.1428571,11.0532171 17.1428571,12 L17.1428571,22.2857143 C17.1428571,23.2325143 17.9103429,24 18.8571429,24 L22.2857143,24 C23.2325143,24 24,23.2325143 24,22.2857143 L24,12 C24,11.0532171 23.2325143,10.2857143 22.2857143,10.2857143 L18.8571429,10.2857143 Z"
                                              id="Path"></path>
                                    </g>
                                </g>
                            </svg>
                        </div>
                        <span class="nav-link-text ms-1">小组构成</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link active" href="/populationAnalysis">
                        <div
                                class="icon icon-shape icon-sm px-0 text-center d-flex align-items-center justify-content-center">
                            <svg width="30px" height="30px" viewBox="0 0 48 48"
                                 version="1.1" xmlns="http://www.w3.org/2000/svg">
                                <title>人口分析</title>
                                <g id="table" stroke="none" stroke-width="1"
                                   fill="none"
                                   fill-rule="evenodd">
                                    <g id="view-grid"
                                       transform="translate(12.000000, 12.000000)"
                                       fill="#FFFFFF"
                                       fill-rule="nonzero">
                                        <path class="color-foreground"
                                              d="M3.42857143,0 C1.53502286,0 0,1.53502286 0,3.42857143 L0,6.85714286 C0,8.75069143 1.53502286,10.2857143 3.42857143,10.2857143 L6.85714286,10.2857143 C8.75069143,10.2857143 10.2857143,8.75069143 10.2857143,6.85714286 L10.2857143,3.42857143 C10.2857143,1.53502286 8.75069143,0 6.85714286,0 L3.42857143,0 Z"
                                              id="Path"></path>
                                        <path class="color-background"
                                              d="M3.42857143,13.7142857 C1.53502286,13.7142857 0,15.2492571 0,17.1428571 L0,20.5714286 C0,22.4650286 1.53502286,24 3.42857143,24 L6.85714286,24 C8.75069143,24 10.2857143,22.4650286 10.2857143,20.5714286 L10.2857143,17.1428571 C10.2857143,15.2492571 8.75069143,13.7142857 6.85714286,13.7142857 L3.42857143,13.7142857 Z"
                                              id="Path"></path>
                                        <path class="color-background"
                                              d="M13.7142857,3.42857143 C13.7142857,1.53502286 15.2492571,0 17.1428571,0 L20.5714286,0 C22.4650286,0 24,1.53502286 24,3.42857143 L24,6.85714286 C24,8.75069143 22.4650286,10.2857143 20.5714286,10.2857143 L17.1428571,10.2857143 C15.2492571,10.2857143 13.7142857,8.75069143 13.7142857,6.85714286 L13.7142857,3.42857143 Z"
                                              id="Path"></path>
                                        <path class="color-foreground"
                                              d="M13.7142857,17.1428571 C13.7142857,15.2492571 15.2492571,13.7142857 17.1428571,13.7142857 L20.5714286,13.7142857 C22.4650286,13.7142857 24,15.2492571 24,17.1428571 L24,20.5714286 C24,22.4650286 22.4650286,24 20.5714286,24 L17.1428571,24 C15.2492571,24 13.7142857,22.4650286 13.7142857,20.5714286 L13.7142857,17.1428571 Z"
                                              id="Path"></path>
                                    </g>
                                </g>
                            </svg>
                        </div>
                        <span class="nav-link-text ms-1">人口分析</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link  " href="/populationPredictions">
                        <div
                                class="icon icon-shape icon-sm px-0 text-center d-flex align-items-center justify-content-center">
                            <svg width="30px" height="30px" viewBox="0 0 48 48"
                                 version="1.1" xmlns="http://www.w3.org/2000/svg">
                                <title>人口预测</title>
                                <g id="wallet" stroke="none" stroke-width="1"
                                   fill="none"
                                   fill-rule="evenodd">
                                    <g id="credit-card"
                                       transform="translate(12.000000, 15.000000)"
                                       fill="#FFFFFF">
                                        <path class="color-background"
                                              d="M3,0 C1.343145,0 0,1.343145 0,3 L0,4.5 L24,4.5 L24,3 C24,1.343145 22.6569,0 21,0 L3,0 Z"
                                              id="Path" fill-rule="nonzero"></path>
                                        <path class="color-foreground"
                                              d="M24,7.5 L0,7.5 L0,15 C0,16.6569 1.343145,18 3,18 L21,18 C22.6569,18 24,16.6569 24,15 L24,7.5 Z M3,13.5 C3,12.67155 3.67158,12 4.5,12 L6,12 C6.82842,12 7.5,12.67155 7.5,13.5 C7.5,14.32845 6.82842,15 6,15 L4.5,15 C3.67158,15 3,14.32845 3,13.5 Z M10.5,12 C9.67158,12 9,12.67155 9,13.5 C9,14.32845 9.67158,15 10.5,15 L12,15 C12.82845,15 13.5,14.32845 13.5,13.5 C13.5,12.67155 12.82845,12 12,12 L10.5,12 Z"
                                              id="Shape"></path>
                                    </g>
                                </g>
                            </svg>
                        </div>
                        <span class="nav-link-text ms-1">人口预测</span>
                    </a>
                </li>
            </ul>
        </div>
    </aside>

    <main
            class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">
        <div class="container-fluid py-4 px-5">
            <div class="row">
                <div class="col-md-12">
                    <div class="d-md-flex align-items-center mb-3 mx-2">
                        <div class="mb-md-0 mb-3">
                            <h3 class="font-weight-bold mb-0">人口分析</h3>
                            <!--                        <p class="mb-0">Apps you might like!</p>-->
                        </div>
                    </div>
                </div>
            </div>

            <hr class="my-0">

            <!--柱状图-->

            <!--        - `row`：创建一个网格行，用于在水平方向上排列列。-->
            <!--        - `m-2`：设置元素的外边距为2个单位（通常为16px）。-->
            <!--        - `col-lg-6 col-md-6`：设置元素在大屏幕（lg）和中等屏幕（md）上占据6个网格列，相当于一半的宽度。-->
            <!--        - `mb-md-0 mb-4`：设置元素在中等屏幕（md）上的下外边距为0，其他屏幕上的下外边距为4个单位。-->
            <!--        - `card`：创建一个卡片容器，用于显示内容和操作。-->
            <!--        - `shadow-xs border`：给卡片添加一个很小的阴影和一个边框。-->
            <!--        - `h-100`：设置元素的高度为100%，即与父元素一样高。-->
            <!--        - `card-body`：创建一个卡片内容区域，用于放置标题、文本、图像等。-->
            <!--        - `py-3`：设置元素的上下内边距为3个单位。-->
            <!--        - `chart`：这是一个自定义的类，没有在Bootstrap中定义，可能是用于绘制图表的样式或脚本。-->
            <!--        - `mb-2`：设置元素的下内边距为2个单位。-->

            <!--        <div class="row m-2">-->
            <!--            <div class="col-lg-6 col-md-6">-->
            <!--                <div class="card shadow-xs border">-->
            <!--                    <div class="card-body py-3">-->
            <!--                        <div id="test01" class="chart mb-2"-->
            <!--                            style="height:400px;"></div>-->
            <!--                    </div>-->
            <!--                </div>-->
            <!--            </div>-->
            <!--        </div>-->

            <div class="row mt-4">

                {% for data in x %}
                    <div class="col">
                        <div class="card shadow-xs border">
                            <div class="card-header pb-0">
                                <div class="d-sm-flex align-items-center mb-3">
                                    <div>
                                        <h6 class="font-weight-semibold text-lg mb-0">{{ pre[loop.index-1] }}与自然增长率变化趋势对比图</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="test{{ loop.index }}" class="chart"
                                     style="height:400px;"></div>
                            </div>
                        </div>
                    </div>
                    {% if loop.index % 2 == 0 %}
                        <!-- 每三个图表换一行 -->
                        </div>
                        <div class="row mt-4">
                    {% endif %}
                {% endfor %}
                </div>


            <!--            <div class="row mt-4">-->

            <!--                <div class="col">-->
            <!--                    <div class="card shadow-xs border">-->
            <!--                        <div class="card-body">-->
            <!--                            <div id="test02" class="chart"-->
            <!--                                 style="height:400px;"></div>-->
            <!--                        </div>-->
            <!--                    </div>-->
            <!--                </div>-->

            <!--            </div>-->

            <div class="row mt-4">
                <div class="col">
                    <div class="card shadow-xs border">
                        <div class="card-header pb-0">
                            <div class="d-sm-flex align-items-center mb-3">
                                <div>
                                    <h6 class="font-weight-semibold text-lg mb-0">各个因素对自然增长率的影响权重图</h6>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="wight" class="chart"
                                 style="height:400px;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!--折线图-->
            <!--        <div class="row">-->
            <!--            <div class="col-lg-12">-->
            <!--                <div class="card shadow-xs border">-->
            <!--                    <div class="card-header pb-0">-->
            <!--                        <div class="d-sm-flex align-items-center mb-3">-->
            <!--                            <div>-->
            <!--                                <h6 class="font-weight-semibold text-lg mb-0">Overview-->
            <!--                                    balance</h6>-->
            <!--                                <p class="text-sm mb-sm-0 mb-2">Here you have details about-->
            <!--                                    the balance.</p>-->
            <!--                            </div>-->
            <!--                            <div class="ms-auto d-flex">-->
            <!--                                <button type="button" class="btn btn-sm btn-white mb-0 me-2">-->
            <!--                                    View report-->
            <!--                                </button>-->
            <!--                            </div>-->
            <!--                        </div>-->
            <!--                        <div class="d-sm-flex align-items-center">-->
            <!--                            <h3 class="mb-0 font-weight-semibold">$87,982.80</h3>-->
            <!--                            <span-->
            <!--                                    class="badge badge-sm border border-success text-success bg-success border-radius-sm ms-sm-3 px-2">-->
            <!--                            <svg width="9" height="9" viewBox="0 0 10 9" fill="none"-->
            <!--                                 xmlns="http://www.w3.org/2000/svg">-->
            <!--                              <path-->
            <!--                                      d="M0.46967 4.46967C0.176777 4.76256 0.176777 5.23744 0.46967 5.53033C0.762563 5.82322 1.23744 5.82322 1.53033 5.53033L0.46967 4.46967ZM5.53033 1.53033C5.82322 1.23744 5.82322 0.762563 5.53033 0.46967C5.23744 0.176777 4.76256 0.176777 4.46967 0.46967L5.53033 1.53033ZM5.53033 0.46967C5.23744 0.176777 4.76256 0.176777 4.46967 0.46967C4.17678 0.762563 4.17678 1.23744 4.46967 1.53033L5.53033 0.46967ZM8.46967 5.53033C8.76256 5.82322 9.23744 5.82322 9.53033 5.53033C9.82322 5.23744 9.82322 4.76256 9.53033 4.46967L8.46967 5.53033ZM1.53033 5.53033L5.53033 1.53033L4.46967 0.46967L0.46967 4.46967L1.53033 5.53033ZM4.46967 1.53033L8.46967 5.53033L9.53033 4.46967L5.53033 0.46967L4.46967 1.53033Z"-->
            <!--                                      fill="#67C23A"></path>-->
            <!--                            </svg>-->
            <!--                            10.5%-->
            <!--                          </span>-->
            <!--                        </div>-->
            <!--                    </div>-->
            <!--                    <div class="card-body p-3">-->
            <!--                        <div class="chart mt-n6">-->
            <!--                            <canvas id="chart-line" class="chart-canvas" height="300"></canvas>-->
            <!--                        </div>-->
            <!--                    </div>-->
            <!--                </div>-->
            <!--            </div>-->
            <!--        </div>-->

        </div>
    </main>

    <!--   Core JS Files   -->
    <script src="../static/js/core/popper.min.js"></script>
    <script src="../static/js/core/bootstrap.min.js"></script>
    <script src="../static/js/plugins/perfect-scrollbar.min.js"></script>
    <script src="../static/js/plugins/smooth-scrollbar.min.js"></script>
    <script src="../static/js/plugins/chartjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="../static/js/plugins/swiper-bundle.min.js" type="text/javascript"></script>
    <script>

        {% for data in x %}
            var dom = document.getElementById('test{{ loop.index }}');
            var myChart = echarts.init(dom, null, {
                renderer: 'canvas',
                useDirtyRect: false
            });
            var app = {};

            var option;
            var xi = {{ data | tojson }}
                option = {
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: ['{{ pre[loop.index-1] }}', '自然增长率']
                    },
                    xAxis: {
                        type: 'category',
                        data: [1970,
                            1971,
                            1972,
                            1973,
                            1974,
                            1975,
                            1976,
                            1977,
                            1978,
                            1979,
                            1980,
                            1981,
                            1982,
                            1983,
                            1984,
                            1985,
                            1986,
                            1987,
                            1988,
                            1989,
                            1990,
                            1991,
                            1992,
                            1993,
                            1994,
                            1995,
                            1996,
                            1997,
                            1998,
                            1999,
                            2000,
                            2001,
                            2002,
                            2003,
                            2004,
                            2005,
                            2006,
                            2007,
                            2008,
                            2009,
                            2010,
                            2011,
                            2012,
                            2013,
                            2014,
                            2015,
                            2016,
                            2017,
                            2018,
                            2019]
                    },
                    yAxis: {
                        type: 'value'
                    },
                    series: [
                        {
                            name: '{{ pre[loop.index-1] }}',
                            data: xi,
                            type: 'line',
                            smooth: true
                        },
                        {
                            name: '自然增长率',
                            data: [2.30909137, 2.1029681, 1.86948334, 1.24564123,
                                0.91730327, 0.36095286, 0.25150687, 0.22961767, 0.15847779,
                                0.20590438, 0.69476311, 0.90088638, 0.46492654, 0.42662045,
                                0.64186421, 0.88082128, 1.07052765, 0.91000688, 0.78414399,
                                0.66557751, 0.40837945, 0.13841269, 0.12929219, 0.0855138,
                                -0.03487679, -0.05859008, -0.12425767, -0.29207485, -0.46718842,
                                -0.57663441, -0.69155269, -0.78275768, -0.86301807, -0.88855546,
                                -0.88490726, -0.99617735, -1.01624244, -1.03265934, -1.07096544,
                                -1.08555823, -1.08555823, -1.05637264, -1.06184494, -1.00894605,
                                -1.05454854, -0.89037956, -0.98888095, -1.26432001, -1.3500527],
                            type: 'line',
                            smooth: true
                        }
                    ]
                };

            if (option && typeof option === 'object') {
                myChart.setOption(option);
            }
        {% endfor %}


        var dom = document.getElementById('wight');
        var myChart = echarts.init(dom, null, {
            renderer: 'canvas',
            useDirtyRect: false
        });
        var app = {};

        var option;
        var wight_data = {{ wight_data|tojson }}
            option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: [
                    {
                        type: 'category',
                        data: ['年份',
                            '出生人口(万)',
                            '总人口(万人)',
                            '中国人均GPA(美元计)',
                            '中国性别比例(按照女生=100)',
                            '城镇人口(城镇+乡村=100)',
                            '乡村人口',
                            '美元兑换人民币汇率',
                            '中国就业人口(万人)'],
                        axisTick: {
                            alignWithLabel: true
                        },
                        axisLabel: {//坐标轴刻度标签的相关设置。
                            formatter: function (params) {
                                var newParamsName = "";// 最终拼接成的字符串
                                var paramsNameNumber = params.length;// 实际标签的个数
                                var provideNumber = 4;// 每行能显示的字的个数
                                var rowNumber = Math.ceil(paramsNameNumber / provideNumber);// 换行的话，需要显示几行，向上取整
                                /**
                                 * 判断标签的个数是否大于规定的个数， 如果大于，则进行换行处理 如果不大于，即等于或小于，就返回原标签
                                 */
                                // 条件等同于rowNumber>1
                                if (paramsNameNumber > provideNumber) {
                                    /** 循环每一行,p表示行 */
                                    for (var p = 0; p < rowNumber; p++) {
                                        var tempStr = "";// 表示每一次截取的字符串
                                        var start = p * provideNumber;// 开始截取的位置
                                        var end = start + provideNumber;// 结束截取的位置
                                        // 此处特殊处理最后一行的索引值
                                        if (p == rowNumber - 1) {
                                            // 最后一次不换行
                                            tempStr = params.substring(start, paramsNameNumber);
                                        } else {
                                            // 每一次拼接字符串并换行
                                            tempStr = params.substring(start, end) + "\n";
                                        }
                                        newParamsName += tempStr;// 最终拼成的字符串
                                    }

                                } else {
                                    // 将旧标签的值赋给新标签
                                    newParamsName = params;
                                }
                                //将最终的字符串返回
                                return newParamsName
                            }

                        }


                    }
                ],
                yAxis: [
                    {
                        type: 'value'
                    }
                ],
                series: [
                    {
                        name: 'Direct',
                        type: 'bar',
                        barWidth: '60%',
                        data: wight_data

                    }
                ]
            };

        if (option && typeof option === 'object') {
            myChart.setOption(option);
        }

    </script>

    <script>
        var win = navigator.platform.indexOf('Win') > -1;
        if (win && document.querySelector('#sidenav-scrollbar')) {
            var options = {
                damping: '0.5'
            }
            Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
        }
    </script>

    <!-- Github buttons -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Control Center for Corporate UI Dashboard: parallax effects, scripts for the example pages etc -->
    <script src="../static/js/corporate-ui-dashboard.min.js?v=1.0.0"></script>

{% endblock %}
